<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>无标题文档</title>
<style type="text/css">
div{ width:100px; height:100px; position:absolute; top:0; left:0; cursor:move; -webkit-user-select:none; overflow:hidden; background:gray;}
div img{ width:100px; height:100px; border:none;}
</style>
</head>

<body>
<div id="div1"><img src="img/6.png"></div>
<div id="div2" style="top:100px; left:100px; background:orange;"><img src="img/7.png"></div>
<div id="div3" style="left:200px; background:purple"><img src="img/12.png"></div>
<div id="div4" style="left:400px; background:pink;"><img src="img/13.png"</div>
</body>
</html>
<script>

function on(ele,type,fn){//负责挖程序池，并且把需要绑定的方法保存到程序池里
	if(ele.addEventListener){
		ele.addEventListener(type,fn,false);
		return ;
	}
	
	//以下是IE的解决方案
	if(!ele["aEvent"+type]){
		ele["aEvent"+type]=[];	
		ele.attachEvent("on"+type,function(){run.call(ele)});
	}
	var a=ele["aEvent"+type];
	for(var i=0;i<a.length;i++){
		if(a[i]==fn)return;	
	}
	a.push(fn);
	
}

function run(e){//负责找到对应的程序池，然后遍历执行这个数组里的所有的相关方法

	var e=e||window.event;
	var type=e.type;
	if(!e.target){
		e.target=e.srcElement;
		e.pageX=(document.documentElement.scrollLeft||document.body.scrollLeft)+e.clientX;
		e.pageY=(document.documentElement.scrollTop||document.body.scrollTop)+e.clientY;
		e.stopPropagation=function(){e.cancelBubble=true;}
		e.preventDefault=function(){e.returnValue=false;};	
	}
	var a=this["aEvent"+type];
	if(a&&a.length){
		for(var i=0;i<a.length;i++){
			if(typeof a[i]=="function"){
				a[i].call(this,e);//用call来执行a数组里的每个方法，是为了让数组里的方法在执行的时候，this指向被绑定的DOM元素
				
			}else{
				a.splice(i,1);
				i--;	
			}
		}
	}
}
function off(ele,type,fn){//负责把对应的方法从程序池里移除
	var a=ele["aEvent"+type];
	if(a&&a.length){
		for(var i=0;i<a.length;i++){
			if(a[i]==fn){
				a[i]=null;
				break;
			}	
		}
	}
}


function fn1(){alert(this.innerHTML+1)}
function fn2(){alert(this.innerHTML+2)}
function fn3(){alert(this.innerHTML+3)}
var ele=document.getElementById("div1");
on(ele,"click",fn1);
on(ele,"click",fn2);
on(ele,"click",fn3);
//fn1,fn2,fn3会各自被执行三

//ele上会有一个自定义属性叫aEventclick,这是个数组，这个数组里有三个方法：fn1,fn2,fn3

//当click事件触发的时候，run方法执行几次：3次
//run方法每执行一次，则去ele.aEventclick这个数组遍历执行里面保存的方法



</script>
