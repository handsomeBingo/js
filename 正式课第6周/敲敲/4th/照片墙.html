<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>照片墙</title>
    <style type="text/css">
        ul{
            position: relative;
            width:480px;
            height:640px;
            margin:100px auto;
            padding:5px;
            list-style: none;
            background: #ccc;
        }
        ul li{
            float: left;
            width:150px;
            height:150px;
            margin:5px;
            overflow: hidden;
            background: lightblue;
            cursor: move;
            -webkit-user-select: none;
            list-style: none;
        }
        li img{
            width:150px;
            height:150px;
            border:none;
        }
    </style>
</head>
<body>
<ul>
    <li><img src="img/1.png" alt=""></li>
    <li><img src="img/2.png" alt=""></li>
    <li><img src="img/3.png" alt=""></li>
    <li><img src="img/4.png" alt=""></li>
    <li><img src="img/5.png" alt=""></li>
    <li><img src="img/6.png" alt=""></li>
    <li><img src="img/7.png" alt=""></li>
    <li><img src="img/8.png" alt=""></li>
    <li><img src="img/9.png" alt=""></li>
    <li><img src="img/10.png" alt=""></li>
    <li><img src="img/11.png" alt=""></li>
    <li><img src="img/12.png" alt=""></li>
</ul>
</body>
<script src="js/utils20160916.js"></script>
<script src="js/animate2.js"></script>
<script src="js/event2.js"></script>
<script src="js/drag_oop.js"></script>
<script charset="utf-8">
var oLis=document.getElementsByTagName("li");
    for(var i=oLis.length-1;i>=0;i--){
        oLis[i].style.left=(oLis[i].l=oLis[i].offsetLeft)+"px";
        oLis[i].style.top=(oLis[i].t=oLis[i].offsetTop)+"px";
        oLis[i].style.position="absolute";
        oLis[i].style.margin=0;
        var b=new Drag(oLis[i]);
        b.on("start",increaseIndex);
        b.on("moving",hitedTest);


    }
var zIndex=0;
function increaseIndex(){
    this.style.zIndex=++zIndex;
}
function goHome(){
    animate(this.ele,{left:this.ele.l,top:this.ele.t},1000,3);
}
function isHited(a,b){
    if((a.offsetLeft+ a.offsetHeight< b.offsetLeft)||(a.offsetTop+ a.offsetHeight< b.offsetHeight)||(a.offsetLeft> b.offsetLeft+ b.offsetWidth)||(a.offsetTop> b.offsetTop+ b.offsetHeight)){
        return false;
    }else{
        return true;
    }
}

    function hitedTest(){
        this.aHited=[];
        for(var i=0;i<oLis.length;i++){
            var oLi=oLis[i];
            if(this.ele==oLi){
                continue;
            }
            if(isHited(this.ele,oLi)){
                this.aHited.push(oLi);
                oLi.style.backgroundColor="red";
            }else{
                oLi.style.backgroundColor="";
            }
        }


    }

    function changePosition(){
        var c=this.aHited;
        if(c&& c.length){
            for(var i=0;i< c.length;i++){
                var oLi=c[i];
                oLi.distance=Math.sprt(Math.pow(this.ele.offsetLeft-oLi.offsetLeft,2)+Math.pow(this.ele.offsetTop-oLi.offsetTop,2));
                oLi.style.backgroundColor="";
            }
            c.sort(function(a,b){return a.distance- b.distance});

            var shortest=c[0];
            animate(shortest,{left:this.ele.l,top:this.ele.t},700,4);
            animate(this.ele)


        }
    }




</script>

</html>